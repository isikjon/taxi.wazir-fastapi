{% extends "base.html" %}

{% block title %}–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –î–∏—Å–ø–µ—Ç—á–µ—Ä—Å–∫–∞—è - taxi.wazir.kg{% endblock %}

{% block header_title %}{% endblock %}

{% block header_right %}
<div class="main__header-search">
    <div class="main__header-search-item">
        <form action="#">
            <input type="search" placeholder="–ü–æ–∏—Å–∫">
            <button><img
                    src="{{ url_for('static', path='/assets/img/ico/search.png') }}"
                    alt="search"></button>
        </form>
    </div>
    <div class="main__header-search-profile">
        <div class="main__header-search-profile-item">
            <a href="#"><img
                    src="{{ url_for('static', path='/assets/img/ico/notif.png') }}"
                    alt="notif"></a>
        </div>
        <div class="main__header-search-profile-item">
            <a href="#"><img
                    src="{{ url_for('static', path='/assets/img/ico/user.png') }}"
                    alt="profile"></a>
        </div>
    </div>
</div>
{% endblock %}

{% block subheader %}
<div class="main__subheader">
    <div class="main__subheader-filter">
        <a href="#"><img
                src="{{ url_for('static', path='/assets/img/ico/burger.png') }}"
                alt="burger"></a>
        <a href="#"><img
                src="{{ url_for('static', path='/assets/img/ico/chart.png') }}"
                alt="chart"></a>
        <a href="#"><img
                src="{{ url_for('static', path='/assets/img/ico/earth.png') }}"
                alt="earth"></a>
    </div>
    <div class="main__subheader-filing">
        <form action="#">
            <select name="filing-date">
                <option value="–î–∞—Ç–∞ –ø–æ–¥–∞—á–∏" disabled selected>–î–∞—Ç–∞
                    –ø–æ–¥–∞—á–∏</option>
                <option value="08.12.2024">08.12.2024</option>
                <option value="09.01.2025">09.01.2025</option>
            </select>
        </form>
    </div>
    <div class="main__subheader-date">
        <form action="#">
            <input type="date" name="first-date-form" id="first-date-form"
                disabled>
            <p>-</p>
            <input type="date" name="last-date-form" id="last-date-form"
                disabled>
        </form>
    </div>
    <div class="main__subheader-add">
        <button>+ –ù–æ–≤—ã–π (F2)</button>
        <button>
            <span class="free"></span>
            –°–≤–æ–±–æ–¥–Ω—ã–µ
        </button>
        <button>
            <span class="busy"></span>
            –ó–∞–Ω—è—Ç—ã–µ
        </button>
        <button>
            <span class="cancelled"></span>
            –û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ
        </button>
    </div>
    <div class="main__subheader-balance">
        <img src="{{ url_for('static', path='/assets/img/ico/balance.png') }}"
            alt="balance">
        <p>
            –ë–∞–ª–∞–Ω—Å: {{ balance|default('0') }}
        </p>
    </div>
</div>
{% endblock %}

{% block content %}
<div class="main__analytics analytics-dashboard">
    <div class="analytics-header">
        <div class="main__table">
            <table>
                <thead>
                    <tr>
                        <th>–í–æ–¥–∏—Ç–µ–ª–∏</th>
                        <th>–ú–∞—à–∏–Ω—ã</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>

    <div class="analytics-charts">
        <div class="main__table">
            <table>
                <tbody>
                    <tr>
                        <td>
                            <div class="chart-block">
                                <div class="donut-container">
                                    <div class="donut-chart donut-1">
                                        <div class="donut-center-text">{{
                                            total_drivers|default('0')
                                            }}</div>
                                    </div>
                                </div>
                                <div class="chart-legend">
                                    <div class="chart-legend__total">–í—Å–µ–≥–æ
                                        –≤–æ–¥–∏—Ç–µ–ª–µ–π:
                                        <span>{{ total_drivers|default('0')
                                            }}</span></div>
                                    <div class="chart-legend__item">
                                        <div
                                            class="legend-color legend-color--blue"></div>
                                        <div>–ê–∫—Ç–∏–≤–Ω—ã–µ</div>
                                        <div>{{ total_drivers|default('0')
                                            }}</div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="chart-block">
                                <div class="donut-container">
                                    <div class="donut-chart donut-2">
                                        <div class="donut-center-text">{{
                                            total_cars|default('0')
                                            }}</div>
                                    </div>
                                </div>
                                <div class="chart-legend">
                                    <div class="chart-legend__total">–í—Å–µ–≥–æ
                                        –º–∞—à–∏–Ω:
                                        <span>{{ total_cars|default('0')
                                            }}</span></div>
                                    <div class="chart-legend__item">
                                        <div
                                            class="legend-color legend-color--green"></div>
                                        <div>–ê–∫—Ç–∏–≤–Ω—ã–µ</div>
                                        <div>{{ total_cars|default('0')
                                            }}</div>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- –ù–æ–≤—ã–µ –±–ª–æ–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ -->
    <div class="analytics-charts">
        <div class="main__table">
            <table>
                <tbody>
                    <!-- 1. –ü–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –∏ –ì—Ä–∞—Ñ–∏–∫ -->
                    <tr>
                        <td>
                            <div class="chart-block">
                                <div class="donut-container">
                                    <div class="donut-chart donut-balance">
                                        <div class="donut-center-text" id="centerBalanceTotal">{{ balance_stats.last_30_days|default('0') }}</div>
                                        <div class="donut-center-currency">—Å–æ–º</div>
                                    </div>
                                </div>
                                <div class="chart-legend">
                                    <div class="chart-legend__total">
                                        üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏—è: 
                                        <select id="balancePeriodSelect" class="period-select-inline">
                                            <option value="7">–ó–∞ 7 –¥–Ω–µ–π</option>
                                            <option value="30" selected>–ó–∞ 30 –¥–Ω–µ–π</option>
                                            <option value="365">–ó–∞ 1 –≥–æ–¥</option>
                                            <option value="all">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</option>
                                        </select>
                                    </div>
                                    <div class="chart-legend__item">
                                        <div class="legend-color legend-color--purple"></div>
                                        <div>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</div>
                                        <div id="balanceCount">{{ balance_stats.count_30_days|default('0') }}</div>
                                    </div>
                                    <div class="chart-legend__item">
                                        <div class="legend-color legend-color--orange"></div>
                                        <div>–ú–∞–∫—Å. –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</div>
                                        <div id="balanceMax">{{ balance_stats.max_amount|default('0') }} —Å–æ–º</div>
                                    </div>
                                    <div class="chart-legend__item">
                                        <div class="legend-color legend-color--red"></div>
                                        <div>–°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞</div>
                                        <div id="balanceAvg">{{ balance_stats.avg_amount|default('0') }} —Å–æ–º</div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="chart-block chart-block--wide">
                                <div class="chart-container-new">
                                    <h4>üìà –ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π</h4>
                                    <canvas id="balanceChart" width="400" height="200"></canvas>
                                </div>
                            </div>
                        </td>
                    </tr>
                    
                    <!-- 2. –ó–∞–∫–∞–∑—ã –∏ –ì—Ä–∞—Ñ–∏–∫ -->
                    <tr>
                        <td>
                            <div class="chart-block">
                                <div class="donut-container">
                                    <div class="donut-chart donut-orders">
                                        <div class="donut-center-text" id="centerOrdersEarnings">{{ orders_stats.earnings_30_days|default('0') }}</div>
                                        <div class="donut-center-currency">—Å–æ–º</div>
                                    </div>
                                </div>
                                <div class="chart-legend">
                                    <div class="chart-legend__total">
                                        üöó –ó–∞–∫–∞–∑—ã: 
                                        <select id="ordersPeriodSelect" class="period-select-inline">
                                            <option value="7">–ó–∞ 7 –¥–Ω–µ–π</option>
                                            <option value="30" selected>–ó–∞ 30 –¥–Ω–µ–π</option>
                                            <option value="365">–ó–∞ 1 –≥–æ–¥</option>
                                            <option value="all">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</option>
                                        </select>
                                    </div>
                                    <div class="chart-legend__item">
                                        <div class="legend-color legend-color--yellow"></div>
                                        <div>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</div>
                                        <div id="ordersCount">{{ orders_stats.count_30_days|default('0') }}</div>
                                    </div>
                                    <div class="chart-legend__item">
                                        <div class="legend-color legend-color--green"></div>
                                        <div>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</div>
                                        <div id="avgOrder">{{ orders_stats.avg_order|default('0') }} —Å–æ–º</div>
                                    </div>
                                    <div class="chart-legend__item">
                                        <div class="legend-color legend-color--blue"></div>
                                        <div>–°–∞–º—ã–π –¥–æ—Ä–æ–≥–æ–π</div>
                                        <div>{{ orders_stats.max_order|default('0') }} —Å–æ–º</div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="chart-block chart-block--wide">
                                <div class="chart-container-new">
                                    <h4>üìä –ì—Ä–∞—Ñ–∏–∫ –¥–æ—Ö–æ–¥–æ–≤ –æ—Ç –∑–∞–∫–∞–∑–æ–≤</h4>
                                    <canvas id="ordersChart" width="400" height="200"></canvas>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    $(document).ready(function() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–µ–Ω—é
        let menu = $(".menu");
        let support = $(".support");
        let settings = $(".settings");
        let navbar__menu_info = $(".navbar__menu-info");
        let navbar__settings = $(".navbar__settings");
        let navbar__menu_settings = $(".navbar__menu-settings");

        menu.click(function() {
            navbar__menu_info.toggleClass("active");
            navbar__settings.removeClass("active");
            navbar__menu_settings.removeClass("active");
        });

        support.click(function() {
            navbar__settings.toggleClass("active");
            navbar__menu_info.removeClass("active");
            navbar__menu_settings.removeClass("active");
        });

        settings.click(function() {
            navbar__menu_settings.toggleClass("active");
            navbar__settings.removeClass("active");
            navbar__menu_info.removeClass("active");
        });
        
        // –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –¥–∏–∞–≥—Ä–∞–º–º
        function setupDonutCharts() {
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –∏ –∞–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π
            const donut1 = document.querySelector('.donut-1');
            if (donut1) {
                donut1.style.background = `conic-gradient(#1E6BC7 0% 100%, transparent 100% 100%)`;
            }
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –∏ –∞–Ω–∏–º–∞—Ü–∏—è –≤—Ç–æ—Ä–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –º–∞—à–∏–Ω
            const donut2 = document.querySelector('.donut-2');
            if (donut2) {
                donut2.style.background = `conic-gradient(#2A9D8F 0% 100%, transparent 100% 100%)`;
            }

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π –±–∞–ª–∞–Ω—Å–∞
            const donutBalance = document.querySelector('.donut-balance');
            if (donutBalance) {
                donutBalance.style.background = `conic-gradient(#9B59B6 0% 75%, transparent 75% 100%)`;
            }
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã –∑–∞–∫–∞–∑–æ–≤
            const donutOrders = document.querySelector('.donut-orders');
            if (donutOrders) {
                donutOrders.style.background = `conic-gradient(#E74C3C 0% 85%, transparent 85% 100%)`;
            }
        }
        
        // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–∏–∞–≥—Ä–∞–º–º
        setupDonutCharts();

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
        initializeCharts();

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è –∑–∞–∫–∞–∑–æ–≤
        $('#ordersPeriodSelect').on('change', function() {
            const period = $(this).val();
            updateOrdersStats(period);
            updateOrdersChart(period);
        });

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π
        $('#balancePeriodSelect').on('change', function() {
            const period = $(this).val();
            updateBalanceStats(period);
            updateBalanceChart(period);
        });
    });

    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
    let balanceChart = null;
    let ordersChart = null;

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
    function initializeCharts() {
        // –ü–æ–¥–∫–ª—é—á–∞–µ–º Chart.js –µ—Å–ª–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω
        if (typeof Chart === 'undefined') {
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/chart.js';
            script.onload = function() {
                createBalanceChart();
                createOrdersChart();
            };
            document.head.appendChild(script);
        } else {
            createBalanceChart();
            createOrdersChart();
        }
    }

    // –ì—Ä–∞—Ñ–∏–∫ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π –±–∞–ª–∞–Ω—Å–∞
    function createBalanceChart() {
        const ctx = document.getElementById('balanceChart');
        if (!ctx) return;

        balanceChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏—è (—Å–æ–º)',
                    data: [],
                    borderColor: '#9B59B6',
                    backgroundColor: 'rgba(155, 89, 182, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#9B59B6',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        labels: { color: '#fff', font: { size: 13 } }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: { color: '#fff', font: { size: 12 } },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    },
                    x: {
                        ticks: { color: '#fff', font: { size: 12 } },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    }
                }
            }
        });
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è 30 –¥–Ω–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        updateBalanceChart('30');
    }

    // –ì—Ä–∞—Ñ–∏–∫ –∑–∞–∫–∞–∑–æ–≤
    function createOrdersChart() {
        const ctx = document.getElementById('ordersChart');
        if (!ctx) return;

        ordersChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: [],
                datasets: [{
                    label: '–î–æ—Ö–æ–¥ (—Å–æ–º)',
                    data: [],
                    backgroundColor: [
                        '#E74C3C',
                        '#E67E22', 
                        '#F1C40F',
                        '#2A9D8F',
                        '#1E6BC7',
                        '#9B59B6',
                        '#E74C3C'
                    ],
                    borderRadius: 8,
                    borderSkipped: false,
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        labels: { color: '#fff', font: { size: 13 } }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: { color: '#fff', font: { size: 12 } },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    },
                    x: {
                        ticks: { color: '#fff', font: { size: 12 } },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    }
                }
            }
        });
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è 30 –¥–Ω–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        updateOrdersChart('30');
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞–∫–∞–∑–æ–≤ —á–µ—Ä–µ–∑ API
    function updateOrdersStats(period) {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
        $('#ordersCount').text('...');
        $('#avgOrder').text('...');
        $('#centerOrdersEarnings').text('...');

        // AJAX –∑–∞–ø—Ä–æ—Å –∫ API
        $.get(`/api/analytics/orders/${period}`)
            .done(function(data) {
                $('#ordersCount').text(data.count);
                $('#avgOrder').text(data.avg + ' —Å–æ–º');
                $('#centerOrdersEarnings').text(data.earnings);
                
                // –ù–µ–±–æ–ª—å—à–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
                $('.donut-center-text').addClass('updated');
                setTimeout(() => $('.donut-center-text').removeClass('updated'), 500);
            })
            .fail(function() {
                $('#ordersCount').text('–û—à–∏–±–∫–∞');
                $('#avgOrder').text('–û—à–∏–±–∫–∞');
                $('#centerOrdersEarnings').text('–û—à–∏–±–∫–∞');
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏–∫–∏');
            });
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ API
    function updateBalanceStats(period) {
        $('#balanceCount').text('...');
        $('#balanceMax').text('...');
        $('#balanceAvg').text('...');
        $('#centerBalanceTotal').text('...');

        $.get(`/api/analytics/balance/${period}`)
            .done(function(data) {
                $('#balanceCount').text(data.count);
                $('#balanceMax').text(data.max + ' —Å–æ–º');
                $('#balanceAvg').text(data.avg + ' —Å–æ–º');
                $('#centerBalanceTotal').text(data.total);
                
                $('.donut-center-text').addClass('updated');
                setTimeout(() => $('.donut-center-text').removeClass('updated'), 500);
            })
            .fail(function() {
                $('#balanceCount').text('–û—à–∏–±–∫–∞');
                $('#balanceMax').text('–û—à–∏–±–∫–∞');
                $('#balanceAvg').text('–û—à–∏–±–∫–∞');
                $('#centerBalanceTotal').text('–û—à–∏–±–∫–∞');
            });
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π
    function updateBalanceChart(period) {
        $.get(`/api/analytics/balance-chart/${period}`)
            .done(function(data) {
                balanceChart.data.labels = data.labels;
                balanceChart.data.datasets[0].data = data.data;
                balanceChart.update();
            })
            .fail(function() {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π');
            });
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤
    function updateOrdersChart(period) {
        $.get(`/api/analytics/orders-chart/${period}`)
            .done(function(data) {
                ordersChart.data.labels = data.labels;
                ordersChart.data.datasets[0].data = data.data;
                ordersChart.update();
            })
            .fail(function() {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤');
            });
    }
</script>

<style>
/* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∏–∞–≥—Ä–∞–º–º */

/* –ù–æ–≤—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è –ª–µ–≥–µ–Ω–¥—ã */
.legend-color--purple {
    background: #9B59B6;
}

.legend-color--orange {
    background: #E67E22;
}

.legend-color--red {
    background: #E74C3C;
}

.legend-color--yellow {
    background: #F1C40F;
}

/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π */
.donut-balance {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    margin: 0 auto;
}

.donut-balance::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80px;
    height: 80px;
    background: #47484c;
    border-radius: 50%;
    z-index: 1;
}

.donut-balance .donut-center-text,
.donut-balance .donut-center-currency {
    position: relative;
    z-index: 2;
}

/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –∑–∞–∫–∞–∑–æ–≤ */
.donut-orders {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    margin: 0 auto;
}

.donut-orders::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80px;
    height: 80px;
    background: #47484c;
    border-radius: 50%;
    z-index: 1;
}

.donut-orders .donut-center-text,
.donut-orders .donut-center-currency {
    position: relative;
    z-index: 2;
}

/* –í–∞–ª—é—Ç–∞ –ø–æ–¥ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º */
.donut-center-currency {
    color: #aaa;
    font-size: 13px;
    font-weight: 400;
    margin-top: -5px;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ */
.donut-center-text.updated {
    color: #2A9D8F;
    transform: scale(1.1);
    transition: all 0.3s ease;
}

/* –ò–Ω–ª–∞–π–Ω —Å–µ–ª–µ–∫—Ç –≤ –ª–µ–≥–µ–Ω–¥–µ */
.period-select-inline {
    background: #47484c;
    color: #fff;
    border: 1px solid #6c757d;
    border-radius: 4px;
    padding: 4px 8px;
    font-size: 12px;
    outline: none;
    margin-left: 8px;
    font-weight: 400;
}

.period-select-inline:focus {
    border-color: #E74C3C;
    box-shadow: 0 0 0 2px rgba(231, 76, 60, 0.25);
}

/* –®–∏—Ä–æ–∫–∏–π –±–ª–æ–∫ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ */
.chart-block--wide {
    width: 92%;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –Ω–æ–≤—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ */
.chart-container-new {
    background: rgba(71, 72, 76, 0.6);
    border-radius: 12px;
    padding: 20px;
    height: 100%;
    border: 1px solid rgba(255, 255, 255, 0.1);
    min-height: 280px;
    position: relative;
}

.chart-container-new h4 {
    color: #fff;
    font-size: 17px;
    font-weight: 500;
    margin: 0 0 15px 0;
    text-align: center;
}

.chart-container-new canvas {
    max-height: 220px !important;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∏–∞–≥—Ä–∞–º–º */
@media (max-width: 1200px) {
    .chart-container-new {
        min-height: 250px;
    }
    
    .chart-container-new canvas {
        max-height: 200px !important;
    }
}

@media (max-width: 768px) {
    .donut-balance, .donut-orders {
        width: 100px;
        height: 100px;
    }
    
    .donut-balance::before, .donut-orders::before {
        width: 70px;
        height: 70px;
    }
    
    .chart-container-new {
        min-height: 200px;
        padding: 15px;
    }
    
    .chart-container-new h4 {
        font-size: 15px;
        font-weight: 400;
    }
    
    .chart-container-new canvas {
        max-height: 150px !important;
    }
}
</style>
{% endblock %}